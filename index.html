<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>AegisGrid Hackathon MVP</title>

  <link
    rel="stylesheet"
    href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
    crossorigin=""
  />
  <script
    src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
    integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
    crossorigin=""
    defer
  ></script>

  <link rel="stylesheet" href="/styles.css" />
</head>
<body>
  <header class="header">
    <div class="brand">
      <div class="logo">ğŸ›¡ï¸</div>
      <div>
        <div class="title">AegisGrid</div>
        <div class="subtitle">Safe routing + reports + SOS</div>
      </div>
    </div>

    <div class="tabs" role="tablist" aria-label="AegisGrid tabs">
      <button class="tab active" data-tab="route" role="tab">Route</button>
      <button class="tab" data-tab="report" role="tab">Report</button>
      <button class="tab" data-tab="sos" role="tab">Safety Hub</button>
    </div>
  </header>

  <main class="main">
    <section class="panel">

      <!-- ROUTE -->
      <div class="tabPane" id="pane-route">
        <h2>Safer Route</h2>
        <p class="muted small">Compares "fastest" vs "safest" using community reports + time-of-day risk scoring.</p>

        <div class="field">
          <label>Start location</label>
          <div class="pick-row">
            <button id="useMyLocation" class="pick-btn pick-green">
              <span>ğŸ“</span> Use my location
            </button>
            <button id="pickStart" class="pick-btn pick-green" data-mode="start">
              <span>ğŸŸ¢</span> Pick on map
            </button>
          </div>
          <div class="row" style="margin-top:8px">
            <input id="start" type="text" placeholder="Or search a start locationâ€¦" />
            <button id="startSearch">Search</button>
          </div>
          <div id="startResults" class="results"></div>
          <div id="startLabel" class="pick-label"></div>
        </div>

        <div class="field">
          <label>Destination</label>
          <div class="pick-row">
            <button id="pickDest" class="pick-btn pick-red" data-mode="dest">
              <span>ğŸ”´</span> Pick on map
            </button>
          </div>
          <div class="row" style="margin-top:8px">
            <input id="dest" type="text" placeholder="Or search a destinationâ€¦" />
            <button id="destSearch">Search</button>
          </div>
          <div id="destResults" class="results"></div>
          <div id="destLabel" class="pick-label"></div>
        </div>

        <div class="field">
          <button id="computeRoutes" class="primary full-width">Compute routes</button>
          <div class="muted small" id="routeStatus" style="margin-top:6px"></div>
        </div>

        <div class="card">
          <div class="row space">
            <div>
              <div class="kpiLabel">Fastest</div>
              <div class="kpi" id="fastestKpi">â€”</div>
            </div>
            <div>
              <div class="kpiLabel">Safest</div>
              <div class="kpi" id="safestKpi">â€”</div>
            </div>
          </div>
          <div class="muted small" style="margin-top:8px">
            Risk score: 0 (low) â†’ 100 (high). Hackathon heuristic only.
          </div>
        </div>

        <details class="details">
          <summary>How risk scoring works</summary>
          <ul>
            <li>Time-of-day baseline (night = higher risk).</li>
            <li>Community reports near route increase risk (decays with distance).</li>
            <li>Safest route = lowest total risk among OSRM alternatives.</li>
          </ul>
        </details>
      </div>

      <!-- REPORT -->
      <div class="tabPane hidden" id="pane-report">
        <h2>Report an issue</h2>
        <p class="muted small">
          Tap the map to drop a pin, fill in the details, then save. Reports are shared with everyone and factor into routing.
        </p>

        <div class="card">
          <div class="muted small">Selected point</div>
          <div id="reportPoint" class="mono">Tap the map to place a pinâ€¦</div>
        </div>

        <div class="field">
          <label for="category">Category</label>
          <select id="category">
            <option value="Broken streetlight">ğŸ”¦ Broken streetlight</option>
            <option value="Harassment hotspot">âš ï¸ Harassment hotspot</option>
            <option value="Stalking / followed">ğŸ‘ï¸ Stalking / followed</option>
            <option value="CCTV not working">ğŸ“· CCTV not working</option>
            <option value="Unsafe alley / poor visibility">ğŸš§ Unsafe alley / poor visibility</option>
            <option value="Other">â“ Other</option>
          </select>
        </div>

        <div class="field">
          <label for="severity">Severity: <span id="severityVal">Medium</span></label>
          <input id="severity" type="range" min="1" max="3" value="2" />
          <div class="sev-labels">
            <span>Low</span><span>Medium</span><span>High</span>
          </div>
        </div>

        <div class="field">
          <label for="note">Note (optional)</label>
          <textarea id="note" rows="3" placeholder="What happened or what did you notice?"></textarea>
        </div>

        <button id="saveReport" class="primary full-width">Save report</button>
        <div class="muted small" id="reportStatus" style="margin-top:6px"></div>

        <div class="icon-legend">
          <div class="legend-title muted small">Report icons on map</div>
          <div class="legend-grid">
            <span class="legend-icon">ğŸ”¦</span><span class="muted small">Broken streetlight</span>
            <span class="legend-icon">âš ï¸</span><span class="muted small">Harassment hotspot</span>
            <span class="legend-icon">ğŸ‘ï¸</span><span class="muted small">Stalking / followed</span>
            <span class="legend-icon">ğŸ“·</span><span class="muted small">CCTV not working</span>
            <span class="legend-icon">ğŸš§</span><span class="muted small">Unsafe alley</span>
            <span class="legend-icon">â“</span><span class="muted small">Other</span>
          </div>
        </div>
      </div>

      <!-- SOS -->
      <div class="tabPane hidden" id="pane-sos">
        <h2>Safety Hub</h2>
        <p class="muted small">
          Speak or type what is happening. Generates a shareable SOS message + immediate safety tips.
        </p>

        <div class="row">
          <button id="startSosVoice" class="primary">ğŸ™ï¸ Start voice</button>
          <button id="stopSosVoice">â¹ï¸ Stop</button>
        </div>

        <div class="field">
          <label for="sosTranscript">Voice transcript</label>
          <textarea id="sosTranscript" rows="4" placeholder="Your spoken words appear here. You can edit before generating SOS."></textarea>
        </div>

        <div class="field">
          <label for="situation">Situation</label>
          <input id="situation" type="text" placeholder="e.g., 'Someone is following me'" />
        </div>

        <div class="field">
          <label for="sosNotes">Extra notes (optional)</label>
          <textarea id="sosNotes" rows="3" placeholder="Clothing, direction, where you're headedâ€¦"></textarea>
        </div>

        <div class="row">
          <button id="generateSos" class="primary">Generate SOS</button>
          <button id="shareSos">Share</button>
          <button id="copySos">Copy</button>
          <button id="speakSos">ğŸ”Š</button>
        </div>

        <div class="muted small" id="sosStatus" style="margin-top:6px"></div>

        <div class="card">
          <div class="muted small">Generated SOS</div>
          <pre id="sosOutput" class="pre">(nothing yet)</pre>
        </div>

        <div class="card">
          <div class="muted small">Immediate guidance</div>
          <ul id="guidanceList" class="guidance"></ul>
        </div>

        <div class="callout">
          <strong>In immediate danger?</strong> Call emergency services â€” UK: 999 / 112
        </div>
      </div>

    </section>

    <section class="mapWrap">
      <div id="map"></div>
      <div class="mapOverlay hidden" id="mapOverlay"></div>
      <div class="pick-mode-banner hidden" id="pickModeBanner"></div>
    </section>
  </main>

  <footer class="footer">
    <div class="muted small">
      Hackathon demo only â€” not a safety guarantee. Inspired by the AegisGrid concept.
    </div>
  </footer>

  <script src="/app.js" defer></script>
</body>
</html>
